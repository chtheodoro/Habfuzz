module test_maxmem
use fdeclarations
use fruit

implicit none

contains
subroutine maxmem_test_based_on_known_values
real, dimension(15) :: ref
ref(1:15)=(/0.700, 0.500, 0.500, 0.700, 0.300, -1.000, -1.000, 0.300, 0.500, 0.500, 0.9, 0.7, 0.5, 0.3, 0.1/)
n=15
high(1:n)=(/0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 1.000, 0.000, 0.000, 0.000, 0.000/)
good(1:n)=(/0.800, 0.000, 0.000, 1.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 1.000, 0.000, 0.000, 0.000/)
moderate(1:n)=(/0.200, 0.600, 1.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.800, 1.000, 0.000, 0.000, 1.000, 0.000, 0.000/)
poor(1:n)=(/0.000, 0.000, 0.000, 0.000, 1.000, 0.000, 0.000, 0.667, 0.000, 0.000, 0.000, 0.000, 0.000, 1.000, 0.000/)
bad(1:n)=(/0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.333, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 1.000/)

call maxmem
do i=1,n
call assert_equals(ref(i), suitability(i)*0.2, 0.02)
end do


end subroutine maxmem_test_based_on_known_values
end module test_maxmem
 


